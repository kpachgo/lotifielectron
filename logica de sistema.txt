ğŸ§  6ï¸âƒ£ Nueva lÃ³gica mental del sistema

Antes:
Sistema basado en letras.

Ahora:
Sistema basado en saldo.

Las letras solo organizan fechas.
El saldo manda.

===================== contexto del proyecto ===============
resumen claro y profesional de cÃ³mo estÃ¡ construido tu sistema actualmente, tanto a nivel lÃ³gico como de base de datos.

---

# ğŸ—ï¸ 1ï¸âƒ£ Arquitectura del Proyecto

### ğŸ”¹ Backend

* **Node.js + Express**
* **MySQL**
* Arquitectura por controladores:

  * `contratos.controller.js`
  * `cuotas.controller.js`
  * `pagos.controller.js`
  * `recibos.controller.js`
  * `deudores.controller.js`

### ğŸ”¹ Frontend

* HTML + Bootstrap
* JS modular (`pagos.js`, etc.)
* ComunicaciÃ³n vÃ­a `fetch()` a API REST

---

# ğŸ’¾ 2ï¸âƒ£ Estructura Financiera (Modelo Real)

El sistema maneja:

âœ” Cuotas fijas
âœ” Capital pendiente dinÃ¡mico
âœ” InterÃ©s por mora
âœ” PenalizaciÃ³n fija
âœ” Pagos parciales
âœ” Pagos extra
âœ” Recibo profesional con saldo acumulado

---

# ğŸ—‚ï¸ 3ï¸âƒ£ Tablas Clave

## ğŸ“˜ contratos

Contiene:

* `monto_financiado`
* `prima`
* `capital_pendiente`
* `tipo_financiamiento`

  * `interes_saldo`
  * `penalizacion_fija`
* `tasa_interes_anual`
* `dias_gracia`
* `penalizacion_fija`
* `estado`
ğŸ‘‰ AquÃ­ vive el estado financiero real del contrato.
---

## ğŸ“— cuotas

Contiene:

* `id_cuota`
* `id_contrato`
* `numero_cuota`
* `fecha_vencimiento`
* `monto_cuota`
* `capital_pendiente`
* `estado`

ğŸ‘‰ La cuota NO representa el capital total.
ğŸ‘‰ Es solo el calendario.

---

## ğŸ“• pagos

Contiene:

* `id_pago`
* `id_cuota`
* `fecha_abono`
* `forma_pago`
* `banco`
* `abono_capital`
* `abono_interes`
* `abono_mora`
* `monto_total`
* `numero_recibo`

ğŸ‘‰ AquÃ­ estÃ¡ el desglose financiero real.
ğŸ‘‰ Nunca se pierde cÃ³mo se aplicÃ³ el dinero.

---

# ğŸ§® 4ï¸âƒ£ Regla Financiera Actual

Orden correcto aplicado:

### 1ï¸âƒ£ InterÃ©s o mora

### 2ï¸âƒ£ Capital

El sistema permite:

* Pagar menos que la cuota
* Pagar solo interÃ©s
* Pagar solo capital
* Pagar mÃ¡s que la cuota
* Abonos extraordinarios

Y solo marca la cuota como `pagada` cuando:

```
capital_pendiente_cuota <= 0
```

---

# ğŸ’° 5ï¸âƒ£ Tipos de Financiamiento

## ğŸ”µ PenalizaciÃ³n fija

Si se pasa de dÃ­as de gracia:

```
abono_mora = penalizacion_fija
```

## ğŸŸ¢ InterÃ©s por cuota vencida

Si hay atraso:
```
interes = (cuota.monto_cuota * tasa * diasAtraso) / 360
```

Importante:
Se calcula usando `fecha_abono`
â†’ Permite pagos retroactivos reales
---
# ğŸ§¾ 6ï¸âƒ£ Recibo Profesional

El recibo imprime:

* Cliente
* CÃ³digo de lote (001A1)
* Cuota mensual
* Mora X Cuotas
* Abono total
* Saldo anterior
* Menos abono (capital)
* Saldo actual
* Saldo acumulado
* Cantidad en letras

Y los saldos se calculan con:

Saldo anterior = monto_financiado - capital_pagado_antes
Saldo actual = monto_financiado - capital_pagado_total
Saldo acumulado = prima + capital_pagado_total

# ğŸ¦ 7ï¸âƒ£ Estado Actual del Sistema

âœ” Permite pagos retroactivos
âœ” Soporta dos mÃ©todos financieros
âœ” Soporta pagos parciales
âœ” Soporta pagos extra
âœ” No pierde historial
âœ” Capital pendiente dinÃ¡mico
âœ” Contrato se cancela automÃ¡ticamente cuando capital llega a 0
---
# ğŸ¯ En quÃ© punto estÃ¡ tu proyecto
EstÃ¡s en un nivel avanzado:
No es un CRUD bÃ¡sico.
Es ya un:
> ğŸ¢ Sistema financiero inmobiliario real con lÃ³gica contable aplicada.
